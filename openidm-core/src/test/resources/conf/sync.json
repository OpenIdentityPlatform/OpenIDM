{
    "mappings": [
        {
            "name": "systemLdapAccounts_managedUser",
            "source": "system/ldap/account",
            "sourceIdsCaseSensitive": false,
            "target": "managed/user",
            "correlationQuery": {
                "type": "text/javascript",
                "source": "var query = {'_queryId' : 'for-userName', 'uid' : source.name};query;"
            },
            "properties": [
                {
                    "source": "cn",
                    "target": "displayName"
                },
                {
                    "source": "description",
                    "target": "description"
                },
                {
                    "source": "givenName",
                    "target": "givenName"
                },
                {
                    "source": "mail",
                    "target": "email"
                },
                {
                    "source": "sn",
                    "target": "familyName"
                },
                {
                    "source": "password",
                    "target": "userPassword",
                    "condition": {
                        "type": "text/javascript",
                        "file": "script/ldapPassword_to_ad_condition.js"
                    }
                },
                {
                    "source": "uid",
                    "target": "userName"
                },
                {
                    "default": "external",
                    "target": "userType"
                },
                {
                    "target": "name",
                    "transform": {
                        "type": "text/javascript",
                        "file": "script/setScimName.js"
                    },
                    "source": ""
                }
            ],
            "onCreate": {
                "type": "text/javascript",
                "source": "target.dn = 'uid=' + source.userName + ',ou=People,dc=example,dc=com';"
            },
            "onUpdate": {
                "type": "text/javascript",
                "source": "java.lang.System.out.println('Hallo: ' + source.userPassword+target.userPassword)"
            },
            "validSource": {
                "type": "text/javascript",
                "source": "source.adPassword != null"
            },
            "validTarget": {
                "type": "text/javascript",
                "source": "target.employeeType == 'external'"
            },
            "policies": [
                {
                    "situation": "CONFIRMED",
                    "action": "UPDATE"
                },
                {
                    "situation": "FOUND",
                    "action": "IGNORE"
                },
                {
                    "situation": "ABSENT",
                    "action": {
                        "comment": "CREATE if employee, IGNORE otherwise?",
                        "type": "text/javascript",
                        "source": "if (1>0) {'CREATE';} else {'IGNORE';}"
                    }
                },
                {
                    "situation": "AMBIGUOUS",
                    "action": "IGNORE"
                },
                {
                    "situation": "MISSING",
                    "action": "IGNORE"
                },
                {
                    "situation": "SOURCE_MISSING",
                    "action": "DELETE"
                },
                {
                    "situation": "UNQUALIFIED",
                    "action": "DELETE"
                },
                {
                    "situation": "UNASSIGNED",
                    "action": "IGNORE"
                }
            ]
        },
        {
            "name": "managedUser_systemADAccounts",
            "source": "managed/user",
            "target": "system/ad/account",
            "targetIdsCaseSensitive": false,
            "properties": [
                {
                    "source": "givenName",
                    "target": "givenName"
                },
                {
                    "source": "familyName",
                    "target": "sn"
                },
                {
                    "source": "displayName",
                    "target": "cn"
                },
                {
                    "source": "userName",
                    "target": "uid"
                },
                {
                    "source": "description",
                    "target": "description"
                },
                {
                    "source": "email",
                    "target": "mail"
                }
            ],
            "onCreate": {
                "type": "text/javascript",
                "source": "target.dn = 'uid=' + source.userName + ',ou=people,o=ad';"
            },
            "policies": [
                {
                    "situation": "CONFIRMED",
                    "action": "UPDATE"
                },
                {
                    "situation": "FOUND",
                    "action": "IGNORE"
                },
                {
                    "situation": "ABSENT",
                    "action": "CREATE"
                },
                {
                    "situation": "AMBIGUOUS",
                    "action": "IGNORE"
                },
                {
                    "situation": "MISSING",
                    "action": "IGNORE"
                },
                {
                    "situation": "SOURCE_MISSING",
                    "action": "DELETE"
                },
                {
                    "situation": "UNQUALIFIED",
                    "action": "DELETE"
                },
                {
                    "situation": "UNASSIGNED",
                    "action": "IGNORE"
                }
            ]
        }
    ]
}
