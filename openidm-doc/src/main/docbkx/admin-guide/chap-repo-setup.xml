<?xml version="1.0" encoding="UTF-8"?>
<!--
  ! CCPL HEADER START
  !
  ! This work is licensed under the Creative Commons
  ! Attribution-NonCommercial-NoDerivs 3.0 Unported License.
  ! To view a copy of this license, visit
  ! http://creativecommons.org/licenses/by-nc-nd/3.0/
  ! or send a letter to Creative Commons, 444 Castro Street,
  ! Suite 900, Mountain View, California, 94041, USA.
  !
  ! You can also obtain a copy of the license at
  ! legal/CC-BY-NC-ND.txt.
  ! See the License for the specific language governing permissions
  ! and limitations under the License.
  !
  ! If applicable, add the following below this CCPL HEADER, with the fields
  ! enclosed by brackets "[]" replaced with your own identifying information:
  !      Portions Copyright [yyyy] [name of copyright owner]
  !
  ! CCPL HEADER END
  !
  !      Copyright 2011 ForgeRock AS
  !    
-->
<chapter xml:id='chap-repo-setup'
 xmlns='http://docbook.org/ns/docbook'
 version='5.0' xml:lang='en'
 xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance'
 xsi:schemaLocation='http://docbook.org/ns/docbook http://docbook.org/xml/5.0/xsd/docbook.xsd'
 xmlns:xlink='http://www.w3.org/1999/xlink'
 xmlns:xinclude='http://www.w3.org/2001/XInclude'>
 <title>Setting Up the Repository</title>

 <para>OpenIDM is configured by default to leverage the embedded NoSQL repository based on OrientDB, however configuring OpenIDM to use a relational database as a repository is possible too. This will be explained in the next chapter.</para>

 <section xml:id="mysql-setup-id"><title>Setting up OpenIDM with MySQL</title>
  <para>Using OpenIDM with a MySQL database can be done by following this procedure:</para>
  <itemizedlist>
   <listitem><para>Get rid of <filename>repo.orientdb.json in openidm/conf/</filename></para></listitem> 
   <listitem><para>Copy the latest mysql java connector in <filename>openidm/bundle/</filename></para></listitem> 
   <listitem><para>Get the repo.jdbc.json from <filename>openidm/samples/misc/</filename></para></listitem>
   <listitem><para>Import DDL from <filename>openidm/db/scripts/mysql/openidm.sql</filename> to your MySQL DB</para></listitem>
   <listitem><para>Eventually create a db user on mysql and grant it the needed rights</para></listitem>
   <listitem><para>Update the db connection params (login/password...) in the repo.jdbc.json</para></listitem>
  </itemizedlist>
  <example>
   <programlisting>
    "connection" : {
        "dbType" : "MYSQL",
        "jndiName" : "",
        "driverClass" : "com.mysql.jdbc.Driver",
        "jdbcUrl" : "jdbc:mysql://localhost:3306/openidm",
        "username" : "root",
        "password" : "",
        "defaultCatalog" : "openidm",
        "maxBatchSize" : 100,
        "maxTxRetry" : 5
    },
   </programlisting>
  </example>

   
 </section>
 <section xml:id="db2-setup-id">
  <title>Setting Up OpenIDM with DB2</title>
  <para>TODO</para>
 </section>
</chapter>
