{
    "auditServiceConfig" : {
        "handlerForQueries" : "repo",
        "availableAuditEventHandlers" : [
            "org.forgerock.audit.handlers.csv.CsvAuditEventHandler",
            "org.forgerock.openidm.audit.impl.RepositoryAuditEventHandler",
            "org.forgerock.openidm.audit.impl.RouterAuditEventHandler"
        ]
    },
    "eventHandlers" : [
        {
            "class" : "org.forgerock.audit.handlers.csv.CsvAuditEventHandler",
            "config" : {
                "name" : "csv",
                "logDirectory" : "&{launcher.working.location}/audit",
                "topics" : [ "access", "activity", "recon", "sync", "authentication", "config" ]
            }
        },
        {
            "class": "org.forgerock.openidm.audit.impl.RepositoryAuditEventHandler",
            "config": {
                "name": "repo",
                "topics" : [ "access", "activity", "recon", "sync", "authentication", "config" ]
            }
        }
    ],
    "extendedEventTypes" : {
        "config": {
            "filter" : {
                "actions" : [
                    "create",
                    "update",
                    "delete",
                    "patch",
                    "action"
                ]
            }
        },
        "activity": {
            "schema": {
                "$schema": "http://json-schema.org/draft-04/schema#",
                "id": "/",
                "type": "object",
                "properties": {
                    "status": {
                        "type": "string"
                    },
                    "message": {
                        "type": "string"
                    },
                    "passwordChanged": {
                        "type": "boolean"
                    }
                }
            },
            "filter" : {
                "actions" : [
                    "create",
                    "update",
                    "delete",
                    "patch",
                    "action"
                ]
            },
            "watchedFields" : [ ],
            "passwordFields" : [ "password" ]
        },
        "access" : {
            "schema": {
                "$schema": "http://json-schema.org/draft-04/schema#",
                "id": "/",
                "type": "object",
                "properties": {
                    "roles": {
                        "type": "array",
                        "items": {
                            "id": "0",
                            "type": "string"
                        }
                    }
                }
            }
        }
    },
    "customEventTypes" : {
        "recon": {
            "schema": {
                "$schema": "http://json-schema.org/draft-04/schema#",
                "id": "/",
                "type": "object",
                "properties": {
                    "_id": {
                        "type": "string"
                    },
                    "transactionId": {
                        "type": "string"
                    },
                    "timestamp": {
                        "type": "string"
                    },
                    "eventName": {
                        "type": "string"
                    },
                    "authentication": {
                        "type": "object",
                        "properties": {
                            "id": {
                                "type": "string"
                            }
                        }
                    },
                    "action": {
                        "type": "string"
                    },
                    "exception": {
                        "type": "string"
                    },
                    "linkQualifier": {
                        "type": "string"
                    },
                    "mapping": {
                        "type": "string"
                    },
                    "message": {
                        "type": "string"
                    },
                    "messageDetail": {
                        "type": "object",
                        "properties": {}
                    },
                    "situation": {
                        "type": "string"
                    },
                    "sourceObjectId": {
                        "type": "string"
                    },
                    "status": {
                        "type": "string"
                    },
                    "targetObjectId": {
                        "type": "string"
                    },
                    "reconciling": {
                        "type": "string"
                    },
                    "ambiguousTargetObjectIds": {
                        "type": "string"
                    },
                    "reconAction": {
                        "type": "string"
                    },
                    "entryType": {
                        "type": "string"
                    },
                    "reconId": {
                        "type": "string"
                    }
                }
            }
        },
        "sync": {
            "schema": {
                "$schema": "http://json-schema.org/draft-04/schema#",
                "id": "/",
                "type": "object",
                "properties": {
                    "_id": {
                        "type": "string"
                    },
                    "transactionId": {
                        "type": "string"
                    },
                    "timestamp": {
                        "type": "string"
                    },
                    "eventName": {
                        "type": "string"
                    },
                    "authentication": {
                        "type": "object",
                        "properties": {
                            "id": {
                                "type": "string"
                            }
                        }
                    },
                    "action": {
                        "type": "string"
                    },
                    "exception": {
                        "type": "string"
                    },
                    "linkQualifier": {
                        "type": "string"
                    },
                    "mapping": {
                        "type": "string"
                    },
                    "message": {
                        "type": "string"
                    },
                    "messageDetail": {
                        "type": "object",
                        "properties": {}
                    },
                    "situation": {
                        "type": "string"
                    },
                    "sourceObjectId": {
                        "type": "string"
                    },
                    "status": {
                        "type": "string"
                    },
                    "targetObjectId": {
                        "type": "string"
                    }
                }
            }
        }
    },
    "exceptionFormatter" : {
        "type" : "text/javascript",
        "file" : "bin/defaults/script/audit/stacktraceFormatter.js"
    }
}
